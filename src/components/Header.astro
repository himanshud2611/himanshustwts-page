---
import ExternalLinkIcon from "./ExternalLinkIcon.astro";

interface Props {
  wide?: boolean;
}

const { wide = false } = Astro.props;

const navLinks = [
  { href: "/", text: "Home" },
  { href: "/posts", text: "Posts" },
  { href: "/podcasts", text: "Podcasts", badge: "new" },
  { href: "/community", text: "Community", mobileText: "Community x Content Full" },
  { href: "https://youtube.com/@Ground_ZeroYT", text: "YouTube", external: true },
];
---

<header class="w-full mb-14 relative z-40">
    {/* Desktop Navigation */}
    <nav class={`hidden md:flex justify-between items-center gap-4 mb-8 ${wide ? "" : "max-w-3xl"}`}>
        <div class="flex items-center gap-4">
            <div class="flex flex-wrap gap-x-4 gap-y-2 text-gruvbox-light/70 dark:text-gruvbox-dark/70">
                {navLinks.map(link => (
                    <a 
                        class="text-base hover:text-gruvbox-light-accent dark:hover:text-gruvbox-dark-accent transition-colors inline-flex items-center gap-1.5 whitespace-nowrap" 
                        href={link.href}
                        target={link.external ? "_blank" : undefined}
                        rel={link.external ? "noopener noreferrer" : undefined}
                    >
                        {link.text === "YouTube" ? (
                            <>
                                <span class="hidden sm:inline">YouTube</span>
                                <span class="sm:hidden">YT</span>
                            </>
                        ) : link.text}
                        
                        {link.badge && (
                            <span class="text-[10px] leading-none px-1.5 py-0.5 font-medium bg-amber-500 dark:bg-orange-600 text-white shadow-[0_0_10px_rgba(245,158,11,0.5)] dark:shadow-[0_0_8px_rgba(234,88,12,0.5)] rounded-full -translate-y-1 -translate-x-0.5">{link.badge}</span>
                        )}
                        {link.external && <ExternalLinkIcon />}
                    </a>
                ))}
            </div>
        </div>
        <button 
            class="theme-toggle p-2 pt-1 md:pt-2 rounded-full text-gruvbox-light/70 dark:text-gruvbox-dark/70 hover:text-gruvbox-light-accent dark:hover:text-gruvbox-dark-accent transition-colors cursor-pointer" 
            aria-label="Toggle theme"
        >
            <svg class="block dark:hidden w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
            </svg>
            <svg class="hidden dark:block w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
            </svg>
        </button>
    </nav>

    {/* Mobile Navigation Bar */}
    <nav class={`flex md:hidden justify-between items-center mb-8 ${wide ? "" : "max-w-3xl"}`}>
        <a href="/" class="font-medium text-lg text-gruvbox-light dark:text-gruvbox-dark">himanshu</a>
        
        <div class="flex items-center gap-4">
            <button 
                class="theme-toggle p-2 rounded-full text-gruvbox-light/70 dark:text-gruvbox-dark/70 hover:text-gruvbox-light-accent dark:hover:text-gruvbox-dark-accent transition-colors" 
                aria-label="Toggle theme"
            >
                <svg class="block dark:hidden w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
                <svg class="hidden dark:block w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
            </button>
            
            <button id="mobile-menu-btn" class="p-2 text-gruvbox-light/70 dark:text-gruvbox-dark/70 hover:text-gruvbox-light-accent dark:hover:text-gruvbox-dark-accent transition-colors" aria-label="Menu">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
        </div>
    </nav>

    {/* Mobile Menu Overlay */}
    <div id="mobile-menu" class="fixed inset-0 z-50 bg-gruvbox-light-bg dark:bg-gruvbox-dark-bg transform translate-x-full transition-transform duration-300 ease-in-out md:hidden">
        <div class="flex flex-col h-full p-6">
            <div class="flex justify-end mb-8">
                <button id="close-menu-btn" class="p-2 text-gruvbox-light/70 dark:text-gruvbox-dark/70 hover:text-gruvbox-light-accent dark:hover:text-gruvbox-dark-accent transition-colors">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div class="flex flex-col gap-6 text-xl font-medium">
                {navLinks.map(link => (
                    <a 
                        class="text-gruvbox-light/70 dark:text-gruvbox-dark/70 hover:text-gruvbox-light-accent dark:hover:text-gruvbox-dark-accent transition-colors flex items-center gap-2" 
                        href={link.href}
                        target={link.external ? "_blank" : undefined}
                        rel={link.external ? "noopener noreferrer" : undefined}
                    >
                        {link.mobileText || link.text}
                        {link.badge && (
                            <span class="text-xs px-2 py-0.5 bg-amber-500 dark:bg-orange-600 text-white rounded-full">{link.badge}</span>
                        )}
                        {link.external && <ExternalLinkIcon />}
                    </a>
                ))}
            </div>
        </div>
    </div>
</header>

<script>
    // Theme toggle
    const themeToggles = document.querySelectorAll('.theme-toggle');
    themeToggles.forEach(btn => {
        btn.addEventListener('click', () => {
            const isDark = document.documentElement.classList.toggle("dark");
            localStorage.setItem("theme", isDark ? "dark" : "light");
        });
    });

    // Mobile menu
    const menuBtn = document.getElementById('mobile-menu-btn');
    const closeBtn = document.getElementById('close-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');

    function toggleMenu() {
        mobileMenu?.classList.toggle('translate-x-full');
        if (!mobileMenu?.classList.contains('translate-x-full')) {
            document.body.style.overflow = 'hidden';
        } else {
            document.body.style.overflow = '';
        }
    }

    menuBtn?.addEventListener('click', toggleMenu);
    closeBtn?.addEventListener('click', toggleMenu);
</script>